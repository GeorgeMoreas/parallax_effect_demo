<html>
	<head>
	    <script src="https://teikn-js.googlecode.com/svn-history/r23/trunk/libraries/kinetic-v3.6.0.js">
	    </script>
	    <script>
	
	        window.onload = function(){	 
	         
	        //	var canvas = new Kinetic.Stage("container", 300, 200));
	        //	var ctx = new Kinetic.Layer();
	        	
	            var canvas = document.getElementById("container", 800, 600);
	            var ctx = canvas.getContext("2d");
	         
	            var widthImg = 800;
	            var heightImg = 600;
	            
	            var mount1_x;
	            var vol_x;
	            var mount2_x;
	            var trees_x;
	            var ground_x;
	            
	            var bg;
	            var moon;
	            var mount1;
	            var vol;
	            var mount2;
	            var trees;
	            var ground;
	            var ball = [];
	            
	            var frameNum = 1;
	            
	            var wait = 0;
	            var ballX = 0;
	            var ballY = 0;
	
		    var mx = 1;
		    var my = 0;
	            var jump = "OFF";
		    var jumpY = 0;
		    var jumpY2 = -50;
	
		window.onkeydown = keydownControl;
	
	
	function keydownControl(e) {
	    if(e.keyCode==37) {
	        mx <= 1 ? mx : mx -= 3;
	    } else
	    if (e.keyCode==38) {
	        my <= -15 ? my : my--;
	    } else if
	    (e.keyCode==39) {
	        mx >= 50 ? mx : mx += 3;
	    } else
	    if (e.keyCode==40) {
	        my >= 0 ? my : my++;
	    } else
	    if (e.keyCode==32) {
	        jump = "ON";
	    }
	}
	
	            init();
	
	             
	            function init(){
	      
	             
	            	// init background 
	            	bg = new Image();
	                bg.src="https://cloud.githubusercontent.com/assets/13951475/9556815/50759188-4d8c-11e5-91e5-2a08cf5605fe.png";
	                bg.onload = function(){
	            	       //ctx.drawImage(bg,0,0);
	                      // Now you can pass the `img` object to various functions
	                };     
	                       
	               	moon = new Image();
	                moon.src="https://cloud.githubusercontent.com/assets/13951475/9556786/5027629c-4d8c-11e5-9c01-bfb0d80757d0.png";
	                moon.onload = function(){
	            	       //ctx.drawImage(moon,200,20);
	                      // Now you can pass the `img` object to various functions
	                };     
	             
	            	// init cloud
	            	mount1 = new Image();
	            	mount1.src = "https://cloud.githubusercontent.com/assets/13951475/9556787/5028015c-4d8c-11e5-935b-7a0d55911ffc.png";
	            	mount1.onload = function(){
	           		   mount1_x = mount1.width;
	            	   //ctx.drawImage(mount1, mount1_x, 120);
	            	};
	            	
	            	mount2 = new Image();
	            	mount2.src = "https://cloud.githubusercontent.com/assets/13951475/9556788/5029ee0e-4d8c-11e5-8279-b4cff041d61e.png";
	            	mount2.onload = function(){
	           		   mount2_x = mount2.width;
	            	   //ctx.drawImage(mount2, mount2_x, 60);
	            	};
					
	            	vol = new Image();
	            	vol.src = "file:///Users/admin/Downloads/v.png";
	            	vol.onload = function(){
	           		   vol_x = widthImg;
	            	   //ctx.drawImage(vol, vol_x, 60);
	            	};
	            	            	
	            	trees = new Image();
	            	trees.src = "https://cloud.githubusercontent.com/assets/13951475/9556816/507ca9a0-4d8c-11e5-89a3-4c20f1664f8a.png";
	            	trees.onload = function(){
	           		   trees_x = trees.width;
	            	   //ctx.drawImage(trees, trees_x, 20);
	            	};
	            	            	
	            	ground = new Image();
	            	ground.src = "https://cloud.githubusercontent.com/assets/13951475/9556789/502a2112-4d8c-11e5-8760-74cca1cf8153.png";
	            	ground.onload = function(){
	           		   ground_x = ground.width;
	            	   //ctx.drawImage(ground, ground_x, 0);
	            	};
	            
	               var i;
	               for (i = 0; i <= 23; i++) {
	            	   ball[i] = new Image();
				   
			   //if (i >= 10) {
			   // 	ball[i].src = "rolling_ball_" + i + ".png";
			   //}
			   //else {
	         	   //	ball[i].src = "rolling_ball_0" + i + ".png";
			   //}
			
				
			   //ball[i].width = 50;
			   //ball[i].height = 50;
	
	             	   ball[i].onload = function(){
	                   	//ctx.drawImage(ball[i], 520, 735);
	               	   }
				
	               }
	            	
				ball[0].src = "https://cloud.githubusercontent.com/assets/13951475/9556790/502a4408-4d8c-11e5-89b3-a8c335a1efda.png";
				ball[1].src = "https://cloud.githubusercontent.com/assets/13951475/9556791/502b1cd4-4d8c-11e5-8d95-d9999f8845cb.png";
				ball[2].src = "https://cloud.githubusercontent.com/assets/13951475/9556793/503beb2c-4d8c-11e5-9f87-429204d08855.png";
				ball[3].src = "https://cloud.githubusercontent.com/assets/13951475/9556792/50395fe2-4d8c-11e5-8625-2e4dc68f5157.png";
				ball[4].src = "https://cloud.githubusercontent.com/assets/13951475/9556794/503ddcca-4d8c-11e5-8155-b354445b3ce8.png";
				ball[5].src = "https://cloud.githubusercontent.com/assets/13951475/9556796/503efd58-4d8c-11e5-843e-f49820eb7684.png";
				ball[6].src = "https://cloud.githubusercontent.com/assets/13951475/9556795/503ebd34-4d8c-11e5-84af-48a14f0d057f.png";
				ball[7].src = "https://cloud.githubusercontent.com/assets/13951475/9556797/503f6c84-4d8c-11e5-8785-b79df6fdbd10.png";
				ball[8].src = "https://cloud.githubusercontent.com/assets/13951475/9556798/5049d480-4d8c-11e5-9c65-0d8454495580.png";
				ball[9].src = "https://cloud.githubusercontent.com/assets/13951475/9556799/504c6a9c-4d8c-11e5-929d-ce7e96659d35.png";
				ball[10].src = "https://cloud.githubusercontent.com/assets/13951475/9556801/504febd6-4d8c-11e5-8273-c5143ee12c53.png";
				ball[11].src = "https://cloud.githubusercontent.com/assets/13951475/9556800/504eee84-4d8c-11e5-81e1-0c47435d6e6e.png";
				ball[12].src = "https://cloud.githubusercontent.com/assets/13951475/9556802/5051127c-4d8c-11e5-8d00-8197252139e1.png";
				ball[13].src = "https://cloud.githubusercontent.com/assets/13951475/9556803/50516952-4d8c-11e5-9127-b1a69dbba943.png";
				ball[14].src = "https://cloud.githubusercontent.com/assets/13951475/9556804/505b116e-4d8c-11e5-9577-1d8974edf0ee.png";
				ball[15].src = "https://cloud.githubusercontent.com/assets/13951475/9556805/505e7f5c-4d8c-11e5-94a2-f20048795e94.png";
				ball[16].src = "https://cloud.githubusercontent.com/assets/13951475/9556806/505fdf78-4d8c-11e5-8616-a89025ff042f.png";
				ball[17].src = "https://cloud.githubusercontent.com/assets/13951475/9556809/5062a91a-4d8c-11e5-88dd-1300326cebf5.png";
				ball[18].src = "https://cloud.githubusercontent.com/assets/13951475/9556808/506213ec-4d8c-11e5-8ac0-b351772c3dbf.png";
				ball[19].src = "https://cloud.githubusercontent.com/assets/13951475/9556807/5060df86-4d8c-11e5-9b1a-d485f60cccb1.png";
				ball[20].src = "https://cloud.githubusercontent.com/assets/13951475/9556810/506bd846-4d8c-11e5-86ae-8218e3eb1cb7.png";
				ball[21].src = "https://cloud.githubusercontent.com/assets/13951475/9556811/5070520e-4d8c-11e5-9735-ddb492f65c6c.png";
				ball[22].src = "https://cloud.githubusercontent.com/assets/13951475/9556813/5070a7f4-4d8c-11e5-9bc4-f31090f50118.png";
				ball[23].src = "https://cloud.githubusercontent.com/assets/13951475/9556812/5070a416-4d8c-11e5-8f35-badcd3370958.png";
	             
	            	return setInterval(main_loop, 10);
	            }
	             
	            function update(){
	            	mount1_x -= 0.3 * mx;
	            	if (mount1_x < 0) {
	            		mount1_x = mount1.width;
	            	}
	            	vol_x -= 0.5 * mx;
	            	if (vol_x < 0 - vol.width) {
	            		vol_x = widthImg;
	            	}
	            	mount2_x -= 0.8 * mx;
	            	if (mount2_x < 0 ) {
	            		mount2_x = mount2.width;
	            	}
	            	trees_x -= 1.3 * mx;
	            	if (trees_x < 0 ) {
	            		trees_x = trees.width;
	            	}
	            	ground_x -= 3.4 * mx;
	            	if (ground_x < 0 ) {
	            		ground_x = ground.width;
	            	}
	            }
	             
	            function draw() {
			var posNeg;
			var stretch = 1.01 - mx * 0.01;
	            		if (jump == "ON"){
					stretch = 1;						
					if (jumpY2 <= 50) {
						posNeg = jumpY2 == 0 ? 0 : jumpY2 / Math.abs(jumpY2);
						ballY = ballY + jumpY2 * jumpY2 * posNeg / 100;
						jumpY2++;
					}
					else {
						jumpY2 = -50;
						jump = "OFF";
					}
				}
				jumpY = jump == "OFF" ? 0 : jumpY + jumpY2 * jumpY2 * posNeg / 3000;
	
	            	ctx.drawImage(bg, 0, 0);
	            	ctx.drawImage(moon, 200, 20);
	            	ctx.drawImage(mount1, mount1_x, 120 + my + jumpY);
	            	ctx.drawImage(mount1, mount1_x-mount1.width, 120 + my + jumpY);
	            	ctx.drawImage(mount1, mount1_x+mount1.width, 120 + my + jumpY);
	            	ctx.drawImage(vol, vol_x, 90 - my - jumpY);
	            	//ctx.drawImage(vol, vol_x-vol.width, 90 - my - jumpY);
	            	//ctx.drawImage(vol, vol_x+vol.width, 90 - my - jumpY);
	            	ctx.drawImage(mount2, mount2_x, 60 - my - jumpY);
	            	ctx.drawImage(mount2, mount2_x-mount2.width, 60 - my - jumpY);
	            	ctx.drawImage(mount2, mount2_x+mount2.width, 60 - my - jumpY);
	            	ctx.drawImage(trees, trees_x, 20 - my * 3 - jumpY * 3);
	            	ctx.drawImage(trees, trees_x-trees.width, 20 - my * 3 - jumpY * 3);
	            	ctx.drawImage(trees, trees_x+trees.width, 20 - my * 3 - jumpY * 3);
	            	ctx.drawImage(ground, ground_x, 0 - my * 6 - jumpY * 6);
	            	ctx.drawImage(ground, ground_x-ground.width, 0 - my * 6 - jumpY * 6);
	            	ctx.drawImage(ground, ground_x+ground.width, 0 - my * 6 - jumpY * 6);
	            	 
	           	 if (wait >= 6 - mx) {
	           	   if (frameNum < 23) {
	            	       frameNum++;
	         	   }
	         	   else {
	         	       frameNum = 0;
	      	         }
	      	       wait = 0;
	 	       }
	
	 	       wait++;
	 	       if (ballX > widthImg + 10) {
	 	          ballX = -50;
	 	       }
	 	       else {
	 	          ballX += 0.3;
	         }
	
	         	   ctx.drawImage(ball[frameNum], ballX, 451 - my * 6 + ballY + (50 - 50 * stretch), 50 / stretch, 50 * stretch);
	            	
	            }
	             
	            function main_loop() {  
	            	draw();
	            	update();
	        //        ctx.draw();  
	        //        canvas.add(ctx);
	            }
	        };
	    </script>
	
	<style type="text/css">
	
	</style>
	
	</head>
	<body bgcolor="black">// onmousedown="return false;">
		<table border="0" align="center">
		        <tr>
				<td colspan="2">
					<p align="center">
						<font size="5" face="arial" color="aliceblue">
							Morphball
						</font>
					</p>
				</td>
			</tr>	        
			<tr>
				<td colspan="2">
						<canvas id="container" width="800" height="600">
	   		            </canvas>
				</td>
			</tr>	        
			<tr>
				<td colspan="2">
					<p align="right">
						<font size="2" face="arial" color="aliceblue" >
							//GM & KG © 2012
						</font>
					</p>
				</td>
			</tr>
				
		</table>
			
	</body>
</html>
